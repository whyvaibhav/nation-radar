<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nation Radar Analysis - Crestal Network Intelligence</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- React and Babel for JSX -->
    <script crossorigin src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        :root {
            /* Crestal Brand Colors */
            --primary-green: #a2ff00;
            --secondary-green: #7dd321;
            --dark-green: #5fa015;
            --neon-green: #00ff41;
            
            /* Dark Theme */
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-tertiary: #111111;
            --bg-card: rgba(162, 255, 0, 0.05);
            --bg-card-hover: rgba(162, 255, 0, 0.1);
            
            /* Text Colors */
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-muted: #666666;
            --text-accent: var(--primary-green);
            
            /* Borders & Effects */
            --border-primary: rgba(162, 255, 0, 0.3);
            --border-secondary: rgba(162, 255, 0, 0.1);
            --glow: 0 0 20px rgba(162, 255, 0, 0.3);
            --glow-strong: 0 0 30px rgba(162, 255, 0, 0.6);
            
            /* Gradients */
            --gradient-primary: linear-gradient(135deg, #a2ff00, #7dd321);
            --gradient-bg: radial-gradient(circle at 25% 25%, rgba(162, 255, 0, 0.1) 0%, transparent 50%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Three.js Background */
        #threejs-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.6;
        }

        /* Header */
        .header {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-primary);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--glow);
        }

        .nav {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .crestal-logo {
            width: 50px;
            height: 50px;
            filter: brightness(1.2) drop-shadow(0 0 10px rgba(162, 255, 0, 0.5));
        }

        .logo-text {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .logo-title {
            font-family: 'Orbitron', monospace;
            font-weight: 900;
            font-size: 1.8rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
        }

        .logo-subtitle {
            font-size: 0.8rem;
            color: var(--text-secondary);
            letter-spacing: 4px;
            text-transform: uppercase;
            font-weight: 300;
        }

        .status-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border-primary);
            border-radius: 25px;
            font-size: 0.9rem;
            box-shadow: var(--glow);
            transition: all 0.3s ease;
        }

        .status-badge:hover {
            box-shadow: var(--glow-strong);
            transform: translateY(-2px);
        }

        .pulse-dot {
            width: 10px;
            height: 10px;
            background: var(--neon-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px var(--neon-green);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.2); }
        }

        /* Hero Section */
        .hero {
            padding: 6rem 2rem;
            text-align: center;
            position: relative;
            background: var(--gradient-bg);
        }

        .hero-content {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 10;
        }

        .hero-title {
            font-family: 'Orbitron', monospace;
            font-size: 4rem;
            font-weight: 900;
            margin-bottom: 1rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 50px rgba(162, 255, 0, 0.3);
            letter-spacing: 3px;
        }

        .hero-subtitle {
            font-size: 1.3rem;
            color: var(--text-secondary);
            max-width: 700px;
            margin: 0 auto 3rem;
            line-height: 1.6;
            font-weight: 300;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 4rem;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            padding: 2.5rem;
            text-align: center;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(162, 255, 0, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .stat-card:hover {
            border-color: var(--primary-green);
            box-shadow: var(--glow-strong);
            transform: translateY(-8px) scale(1.02);
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-icon {
            font-size: 2.5rem;
            color: var(--primary-green);
            margin-bottom: 1rem;
            filter: drop-shadow(0 0 10px rgba(162, 255, 0, 0.5));
        }

        .stat-number {
            font-family: 'Orbitron', monospace;
            font-size: 3rem;
            font-weight: 900;
            color: var(--primary-green);
            display: block;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 20px rgba(162, 255, 0, 0.5);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }

        /* Main Content */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 4rem 2rem;
        }

        .section {
            margin-bottom: 5rem;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 3rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-secondary);
        }

        .section-title {
            font-family: 'Orbitron', monospace;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .section-icon {
            font-size: 2rem;
            color: var(--primary-green);
            filter: drop-shadow(0 0 10px rgba(162, 255, 0, 0.5));
        }

        /* Controls */
        .controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 14px 28px;
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            background: var(--bg-card);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .btn:hover {
            border-color: var(--primary-green);
            box-shadow: var(--glow);
            transform: translateY(-2px);
        }

        .btn:hover::before {
            left: 0;
            opacity: 0.1;
        }

        .btn.primary {
            background: var(--gradient-primary);
            color: var(--bg-primary);
            border-color: var(--primary-green);
            font-weight: 600;
        }

        .btn.primary:hover {
            box-shadow: var(--glow-strong);
            transform: translateY(-3px);
        }

        /* Cards */
        .card-container {
            background: var(--bg-card);
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            overflow: hidden;
            backdrop-filter: blur(10px);
            box-shadow: var(--glow);
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 4rem;
            color: var(--text-secondary);
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--border-secondary);
            border-top: 3px solid var(--primary-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 2rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-title { font-size: 2.5rem; }
            .stats-grid { grid-template-columns: 1fr; }
            .controls { flex-direction: column; }
            .nav { flex-direction: column; gap: 1rem; padding: 1rem; }
            .logo-title { font-size: 1.5rem; }
            .section-title { font-size: 2rem; }
        }

        /* React Component Styles */
        .tweet-card {
            background: var(--bg-card);
            border: 1px solid var(--border-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .tweet-card:hover {
            border-color: var(--primary-green);
            box-shadow: var(--glow);
            transform: translateX(5px);
        }

        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
            background: transparent;
        }

        .leaderboard-table th,
        .leaderboard-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-secondary);
        }

        .leaderboard-table th {
            background: var(--bg-card);
            color: var(--primary-green);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }

        .leaderboard-table tr:hover {
            background: var(--bg-card-hover);
        }

        .rank-badge {
            background: var(--gradient-primary);
            color: var(--bg-primary);
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-family: 'Orbitron', monospace;
        }

        .score-badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-weight: 600;
            font-family: 'Orbitron', monospace;
            font-size: 0.9rem;
        }

        .score-high { 
            background: rgba(162, 255, 0, 0.2); 
            color: var(--primary-green); 
            border: 1px solid var(--primary-green);
        }
        .score-medium { 
            background: rgba(255, 193, 7, 0.2); 
            color: #ffc107; 
            border: 1px solid #ffc107;
        }
        .score-low { 
            background: rgba(220, 53, 69, 0.2); 
            color: #dc3545; 
            border: 1px solid #dc3545;
        }
    </style>
</head>
<body>
    <!-- Three.js Background -->
    <canvas id="threejs-bg"></canvas>

    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="logo-container">
                <svg class="crestal-logo" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                    <!-- Crestal $ Symbol -->
                    <defs>
                        <linearGradient id="greenGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#a2ff00;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#7dd321;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    
                    <!-- Dollar Sign Body -->
                    <path d="M100 20 C140 20, 170 50, 170 90 C170 110, 160 125, 145 135 C155 145, 165 160, 165 180 C165 220, 135 250, 95 250 C55 250, 25 220, 25 180" 
                          stroke="url(#greenGradient)" stroke-width="20" fill="none" stroke-linecap="round"/>
                    
                    <!-- Dollar Sign Lines -->
                    <line x1="100" y1="10" x2="100" y2="50" stroke="url(#greenGradient)" stroke-width="15" stroke-linecap="round"/>
                    <line x1="100" y1="150" x2="100" y2="190" stroke="url(#greenGradient)" stroke-width="15" stroke-linecap="round"/>
                    
                    <!-- Nation Text -->
                    <text x="100" y="280" text-anchor="middle" fill="url(#greenGradient)" font-family="Orbitron" font-weight="900" font-size="24">NATION</text>
                </svg>
                
                <div class="logo-text">
                    <div class="logo-title">NATION RADAR</div>
                    <div class="logo-subtitle">ANALYSIS</div>
                </div>
            </div>
            
            <div class="status-badge">
                <div class="pulse-dot"></div>
                <span>Live Monitoring</span>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1 class="hero-title">NATION RADAR ANALYSIS</h1>
            <p class="hero-subtitle">
                Advanced AI-powered intelligence system monitoring the Crestal Network ecosystem. 
                Real-time sentiment analysis, community insights, and quality scoring powered by Nation Agent.
            </p>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <span class="stat-number" id="total-tweets">0</span>
                    <div class="stat-label">Tweets Analyzed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <span class="stat-number" id="avg-score">0.0</span>
                    <div class="stat-label">AI Quality Score</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <span class="stat-number" id="active-contributors">0</span>
                    <div class="stat-label">Active Contributors</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <span class="stat-number" id="last-update">--:--</span>
                    <div class="stat-label">Last Update</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Controls -->
        <section class="section">
            <div class="section-header">
                <i class="section-icon fas fa-cogs"></i>
                <h2 class="section-title">Control Center</h2>
            </div>
            <div class="controls">
                <button class="btn primary" onclick="refreshData()">
                    <i class="fas fa-sync-alt"></i>
                    Refresh Data
                </button>
                <button class="btn" onclick="runPipeline()">
                    <i class="fas fa-rocket"></i>
                    Run Analysis
                </button>
                <button class="btn" onclick="exportData()">
                    <i class="fas fa-download"></i>
                    Export Report
                </button>
            </div>
        </section>

        <!-- React App Container -->
        <div id="react-app"></div>
    </main>

    <!-- Scripts -->
    <script>
        // Three.js Background Animation
        function initThreeJS() {
            const canvas = document.getElementById('threejs-bg');
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true });
            
            renderer.setSize(window.innerWidth, window.innerHeight);
            
            // Create particle system
            const geometry = new THREE.BufferGeometry();
            const particleCount = 1000;
            const positions = new Float32Array(particleCount * 3);
            
            for (let i = 0; i < particleCount * 3; i++) {
                positions[i] = (Math.random() - 0.5) * 100;
            }
            
            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            
            const material = new THREE.PointsMaterial({
                color: 0xa2ff00,
                size: 0.5,
                transparent: true,
                opacity: 0.6
            });
            
            const particles = new THREE.Points(geometry, material);
            scene.add(particles);
            
            camera.position.z = 30;
            
            // Animation
            function animate() {
                requestAnimationFrame(animate);
                
                particles.rotation.x += 0.0005;
                particles.rotation.y += 0.001;
                
                const positions = particles.geometry.attributes.position.array;
                for (let i = 0; i < positions.length; i += 3) {
                    positions[i + 1] += Math.sin(Date.now() * 0.001 + positions[i]) * 0.01;
                }
                particles.geometry.attributes.position.needsUpdate = true;
                
                renderer.render(scene, camera);
            }
            
            animate();
            
            // Handle resize
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        }
        
        // Initialize Three.js
        initThreeJS();
    </script>
    
    <!-- React Components -->
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Main App Component
        function App() {
            const [data, setData] = useState([]);
            const [leaderboard, setLeaderboard] = useState([]);
            const [loading, setLoading] = useState(true);
            
            useEffect(() => {
                loadData();
                loadLeaderboard();
                
                // Auto-refresh every 5 minutes
                const interval = setInterval(() => {
                    loadData();
                    loadLeaderboard();
                }, 5 * 60 * 1000);
                
                return () => clearInterval(interval);
            }, []);
            
            const loadData = async () => {
                try {
                    const response = await fetch('/api/crestal-data');
                    const result = await response.json();
                    
                    if (result.success) {
                        setData(result.data || []);
                        updateStats(result.stats);
                    }
                } catch (error) {
                    console.error('Failed to load data:', error);
                } finally {
                    setLoading(false);
                }
            };
            
            const loadLeaderboard = async () => {
                try {
                    const response = await fetch('/api/leaderboard?limit=10');
                    const result = await response.json();
                    
                    if (result.success) {
                        setLeaderboard(result.leaderboard || []);
                    }
                } catch (error) {
                    console.error('Failed to load leaderboard:', error);
                }
            };
            
            const updateStats = (stats) => {
                if (stats) {
                    document.getElementById('total-tweets').textContent = stats.total_tweets || data.length;
                    document.getElementById('avg-score').textContent = (stats.avg_score || 0).toFixed(2);
                    document.getElementById('active-contributors').textContent = stats.unique_users || 0;
                    document.getElementById('last-update').textContent = new Date().toLocaleTimeString();
                }
            };
            
            const getScoreClass = (score) => {
                if (score >= 1.0) return 'score-high';
                if (score >= 0.5) return 'score-medium';
                return 'score-low';
            };
            
            if (loading) {
                return (
                    <div className="loading">
                        <div className="loading-spinner"></div>
                        <h3>Initializing Nation Radar Analysis...</h3>
                        <p>Loading intelligence data from the Crestal Network</p>
                    </div>
                );
            }
            
            return (
                <div>
                    {/* Leaderboard Section */}
                    <section className="section">
                        <div className="section-header">
                            <i className="section-icon fas fa-trophy"></i>
                            <h2 className="section-title">Top Contributors</h2>
                        </div>
                        <div className="card-container">
                            {leaderboard.length > 0 ? (
                                <table className="leaderboard-table">
                                    <thead>
                                        <tr>
                                            <th>Rank</th>
                                            <th>Contributor</th>
                                            <th>Avg Score</th>
                                            <th>Best Score</th>
                                            <th>Contributions</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {leaderboard.map((user, index) => (
                                            <tr key={user.username}>
                                                <td>
                                                    <span className="rank-badge">#{index + 1}</span>
                                                </td>
                                                <td>
                                                    <div style={{display: 'flex', alignItems: 'center', gap: '12px'}}>
                                                        <div style={{
                                                            width: '40px',
                                                            height: '40px',
                                                            background: 'var(--gradient-primary)',
                                                            borderRadius: '50%',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            color: 'var(--bg-primary)',
                                                            fontWeight: '700'
                                                        }}>
                                                            {user.username.substring(0, 2).toUpperCase()}
                                                        </div>
                                                        <div>
                                                            <div style={{fontWeight: '600', color: 'var(--text-primary)'}}>
                                                                @{user.username}
                                                            </div>
                                                            <div style={{fontSize: '0.8rem', color: 'var(--text-secondary)'}}>
                                                                Crestal Contributor
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>
                                                    <span className={`score-badge ${getScoreClass(user.avg_score)}`}>
                                                        {user.avg_score.toFixed(3)}
                                                    </span>
                                                </td>
                                                <td>
                                                    <span className={`score-badge ${getScoreClass(user.best_score)}`}>
                                                        {user.best_score.toFixed(3)}
                                                    </span>
                                                </td>
                                                <td style={{fontFamily: 'Orbitron, monospace', color: 'var(--primary-green)'}}>
                                                    {user.tweet_count}
                                                </td>
                                                <td>
                                                    <div style={{
                                                        padding: '4px 12px',
                                                        background: 'rgba(162, 255, 0, 0.1)',
                                                        borderRadius: '20px',
                                                        fontSize: '0.8rem',
                                                        color: 'var(--primary-green)'
                                                    }}>
                                                        Active
                                                    </div>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            ) : (
                                <div className="loading">
                                    <i className="fas fa-users" style={{fontSize: '3rem', marginBottom: '1rem', opacity: '0.5'}}></i>
                                    <h3>Building Contributor Database</h3>
                                    <p>Intelligence gathering in progress...</p>
                                </div>
                            )}
                        </div>
                    </section>
                    
                    {/* Recent Analysis Section */}
                    <section className="section">
                        <div className="section-header">
                            <i className="section-icon fas fa-radar"></i>
                            <h2 className="section-title">Recent Intelligence</h2>
                        </div>
                        <div>
                            {data.length > 0 ? (
                                data.slice(0, 10).map((tweet, index) => (
                                    <div key={tweet.id || index} className="tweet-card">
                                        <div style={{display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '1rem'}}>
                                            <div style={{
                                                width: '48px',
                                                height: '48px',
                                                background: 'var(--gradient-primary)',
                                                borderRadius: '50%',
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                color: 'var(--bg-primary)',
                                                fontWeight: '700'
                                            }}>
                                                {(tweet.username || 'U').substring(0, 2).toUpperCase()}
                                            </div>
                                            <div style={{flex: 1}}>
                                                <h3 style={{color: 'var(--text-primary)', marginBottom: '0.25rem'}}>
                                                    @{tweet.username || 'unknown'}
                                                </h3>
                                                <div style={{color: 'var(--text-secondary)', fontSize: '0.9rem'}}>
                                                    Crestal Community Member
                                                </div>
                                            </div>
                                            <div className={`score-badge ${getScoreClass(tweet.score || 0)}`}>
                                                {(tweet.score || 0).toFixed(3)}
                                            </div>
                                        </div>
                                        <div style={{marginBottom: '1rem', lineHeight: '1.6'}}>
                                            {tweet.text || 'No content'}
                                        </div>
                                        <div style={{
                                            display: 'flex',
                                            gap: '1.5rem',
                                            paddingTop: '1rem',
                                            borderTop: '1px solid var(--border-secondary)',
                                            fontSize: '0.9rem',
                                            color: 'var(--text-secondary)'
                                        }}>
                                            <div style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                                <i className="fas fa-heart"></i>
                                                {tweet.engagement?.likes || 0}
                                            </div>
                                            <div style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                                <i className="fas fa-retweet"></i>
                                                {tweet.engagement?.retweets || 0}
                                            </div>
                                            <div style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                                <i className="fas fa-reply"></i>
                                                {tweet.engagement?.replies || 0}
                                            </div>
                                            <div style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                                <i className="fas fa-eye"></i>
                                                {tweet.engagement?.views || 0}
                                            </div>
                                        </div>
                                    </div>
                                ))
                            ) : (
                                <div className="loading">
                                    <i className="fas fa-radar" style={{fontSize: '3rem', marginBottom: '1rem', opacity: '0.5'}}></i>
                                    <h3>Scanning for Intelligence</h3>
                                    <p>Nation Radar is analyzing the Crestal Network ecosystem...</p>
                                </div>
                            )}
                        </div>
                    </section>
                </div>
            );
        }
        
        // Render the app
        ReactDOM.render(<App />, document.getElementById('react-app'));
        
        // Global functions for buttons
        window.refreshData = async () => {
            const app = document.getElementById('react-app');
            ReactDOM.unmountComponentAtNode(app);
            ReactDOM.render(<App />, app);
        };
        
        window.runPipeline = async () => {
            const btn = event.target;
            const originalHTML = btn.innerHTML;
            
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analyzing...';
            btn.disabled = true;
            
            try {
                const response = await fetch('/api/run-pipeline', { method: 'POST' });
                const result = await response.json();
                
                if (result.success) {
                    btn.innerHTML = '<i class="fas fa-check"></i> Analysis Complete!';
                    setTimeout(() => window.refreshData(), 2000);
                } else {
                    btn.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Error';
                }
            } catch (error) {
                btn.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Error';
            }
            
            setTimeout(() => {
                btn.innerHTML = originalHTML;
                btn.disabled = false;
            }, 3000);
        };
        
        window.exportData = () => {
            const link = document.createElement('a');
            link.href = '/api/crestal-data?format=csv';
            link.download = `nation-radar-${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
        };
    </script>
</body>
</html>